{% load static %}

<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" type="image/x-icon" href="{% static 'store/images/images.png' %}">
    <title>{% block title %}Teryaq Pharmacy{% endblock %}</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 font-sans flex flex-col min-h-screen">

<!-- ================= HEADER ================= -->
<header class="bg-green-600 text-white p-4 shadow-md fixed w-full z-50">
  <div class="container mx-auto flex items-center justify-between">

    <!-- Logo -->
    <div class="flex-shrink-0 flex items-center -ml-4 "> 
      <a href="{% url 'store:home' %}">
        <img
          src="{% static 'store/images/Finised logo.png' %}"
          alt="Teryaq Pharmacy Logo"
          class="h-16 w-[370px] object-contain"
        />
      </a>
    </div>

   
    <div class="hidden md:flex items-center space-x-10 font-semibold text-lg -ml-40"> <!-- Ù‚Ø±Ø¨Øª Ø§Ù„Ù„ÙŠÙ†ÙƒØ§Øª Ø£ÙƒØªØ± Ù„Ù„ÙˆØ¬Ùˆ -->
      <a href="{% url 'store:home' %}" class="text-white px-3 py-1 rounded hover:bg-white hover:text-green-600 hover:shadow-md transition">
        Home
      </a>
      <a href="{% url 'store:medicine_list' %}" class="text-white px-3 py-1 rounded hover:bg-white hover:text-green-600 hover:shadow-md transition">
        Medicines
      </a>
      <!-- Categories -->
      <div class="relative group">
        <button class="hover:text-gray-200 focus:outline-none text-lg transition duration-300 px-3 py-1 rounded">
          Categories â–¾
        </button>
        <div class="absolute hidden group-hover:block bg-white text-black mt-2 rounded shadow-md min-w-[200px] z-50">
          {% for category in categories %}
          <a href="{% url 'store:category_detail' category.id %}" class="block px-4 py-2 hover:bg-gray-200">
            {{ category.name }}
          </a>
          {% empty %}
          <p class="px-4 py-2 text-gray-500">Ù„Ø§ ØªÙˆØ¬Ø¯ ÙØ¦Ø§Øª</p>
          {% endfor %}
        </div>
      </div>
    </div>

    <!-- Search -->
    <div class="flex-1 relative max-w-lg -ml-14"> <!-- ØµØºØ±Øª Ø§Ù„Ø¨ÙˆÙƒØ³ Ø´ÙˆÙŠÙ‡ ÙˆØ­Ø±ÙƒØªÙ‡ Ù„Ù„Ø´Ù…Ø§Ù„ -->
      <input
        type="text"
        id="search-input"
        placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ø¯ÙˆØ§Ø¡..."
        class="w-full border border-gray-300 rounded-full py-2 px-10 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-green-500 text-gray-900"
      />
      <!-- Search Icon -->
      <div class="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500 pointer-events-none">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
            d="M21 21l-4.35-4.35M17 11a6 6 0 11-12 0 6 6 0 0112 0z"/>
        </svg>
      </div>
      <div
        id="search-results"
        class="absolute mt-1 w-full rounded-lg shadow-lg max-h-64 overflow-y-auto z-50 hidden"
        style="background-color:#F5E4D0; color:black;"
      ></div>
    </div>

    <!-- Cart & Logout -->
    <div class="flex items-center space-x-6 ml-4">
      <a href="{% url 'store:cart' %}" class="relative mr-3">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 inline-block" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
            d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2 9h14l-2-9M17 13H7"/>
        </svg>
        {% if request.session.cart %}
        <span class="absolute -top-2 -right-2 bg-red-600 text-white text-xs w-5 h-5 flex items-center justify-center rounded-full">
          {{ request.session.cart|length }}
        </span>
        {% endif %}
      </a>

      {% if request.user.is_authenticated %}
      <form action="{% url 'store:logout' %}" method="post">
        {% csrf_token %}
        <button type="submit" class="bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700 transition">
          Logout
        </button>
      </form>
      {% endif %}
    </div>

  </div>
</header>


<!-- ================= MAIN ================= -->
<main class="flex-1 pt-28 container mx-auto p-4">
    {% block content %}{% endblock %}
</main>

<!-- ================= FOOTER ================= -->
<footer class="bg-gray-900 text-white mt-auto pt-10 pb-6">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
      <div>
        <h3 class="text-xl font-bold mb-4">Teryaq Pharmacy</h3>
        <p class="text-gray-400 mb-2">
          Ù†Ù‚Ø¯Ù… Ø£ÙØ¶Ù„ Ø§Ù„Ø£Ø¯ÙˆÙŠØ© ÙˆÙ…Ù†ØªØ¬Ø§Øª Ø§Ù„Ø¹Ù†Ø§ÙŠØ© Ø¨Ø§Ù„ØµØ­Ø© ÙˆØ§Ù„Ø¬Ù…Ø§Ù„. Ù‡Ø¯ÙÙ†Ø§ ØªÙ‚Ø¯ÙŠÙ… Ø®Ø¯Ù…Ø© Ø³Ø±ÙŠØ¹Ø© ÙˆÙ…ÙˆØ«ÙˆÙ‚Ø© Ù„Ø¬Ù…ÙŠØ¹ Ø¹Ù…Ù„Ø§Ø¦Ù†Ø§.
        </p>
        <p class="text-gray-400">Opening Hours: Sat - Thu, 8AM - 10PM</p>
      </div>
      <div>
        <h3 class="text-xl font-bold mb-4">Quick Links</h3>
        <ul class="space-y-2">
          <li><a href="#" class="hover:text-green-500 transition">Home</a></li>
          <li><a href="#" class="hover:text-green-500 transition">Shop</a></li>
          <li><a href="#" class="hover:text-green-500 transition">About Us</a></li>
          <li><a href="#" class="hover:text-green-500 transition">Contact</a></li>
        </ul>
      </div>
      <div>
        <h3 class="text-xl font-bold mb-4">Contact Us</h3>
        <ul class="space-y-2 text-gray-400">
          <li> 123 Teryaq St, Cairo, Egypt</li>
          <li>ğŸ“ +20 123 456 7890</li>
          <li>âœ‰ï¸ info@teryaqpharmacy.com</li>
          <li>ğŸŒ www.teryaqpharmacy.com</li>
        </ul>
        <div class="flex space-x-4 mt-4">
          <a href="#" class="hover:text-green-500 transition">Facebook</a>
          <a href="#" class="hover:text-green-500 transition">Instagram</a>
          <a href="#" class="hover:text-green-500 transition">Twitter</a>
        </div>
      </div>
    </div>
    <br>
    <div class="w-100 h-px bg-gray-500 mx-auto my-4"></div>
    <div class="mt-8 text-sm text-center">
      &copy; 2025 Teryaq Pharmacy. All rights reserved. Made with
      <span class="text-red-500">&hearts;</span> by
      <a href="https://www.linkedin.com/in/mohamed-ayman-812b46332" target="_blank" class="text-blue-500 underline hover:text-blue-700 transition">
        Abo_AYMAN
      </a>.
    </div>
  </div>
</footer>

<!-- ================= AJAX SEARCH SCRIPT ================= -->
<script>
const input = document.getElementById('search-input');
const resultsDiv = document.getElementById('search-results');

input.addEventListener('input', function() {
    const query = input.value.trim();
    if (!query) {
        resultsDiv.innerHTML = '';
        resultsDiv.classList.add('hidden');
        return;
    }

    fetch(`/ajax/search/?q=${encodeURIComponent(query)}`)
        .then(response => response.json())
        .then(data => {
            resultsDiv.innerHTML = '';
            if (data.results.length === 0) {
                resultsDiv.innerHTML = `<p class="p-2 text-gray-500">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬</p>`;
            } else {
                data.results.forEach(item => {
                    const div = document.createElement('div');
                    div.className = "px-4 py-2 cursor-pointer hover:bg-[#d1b89b]";
                    div.style.backgroundColor = "#F5E4D0"; // Ø®Ù„ÙÙŠØ© Ø§Ù„Ø¨ÙˆÙƒØ³ Ø¨Ù†ÙŠ ÙØ§ØªØ­
                    div.style.color = "black";
                    div.textContent = `${item.name} - ${item.price} Ø¬Ù†ÙŠÙ‡`;
                    div.addEventListener('click', () => {
                        window.location.href = `/medicine/${item.id}/`;
                    });
                    resultsDiv.appendChild(div);
                });
            }
            resultsDiv.classList.remove('hidden');
        })
        .catch(err => {
            console.error(err);
            resultsDiv.innerHTML = `<p class="p-2 text-red-500">Ø­Ø¯Ø« Ø®Ø·Ø£</p>`;
        });
});
</script>

</body>
</html>
